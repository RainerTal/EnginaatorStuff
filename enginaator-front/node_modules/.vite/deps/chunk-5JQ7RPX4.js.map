{
  "version": 3,
  "sources": ["../../@zag-js/aria-hidden/dist/index.mjs"],
  "sourcesContent": ["// src/walk-tree-outside.ts\nvar counterMap = /* @__PURE__ */ new WeakMap();\nvar uncontrolledNodes = /* @__PURE__ */ new WeakMap();\nvar markerMap = {};\nvar lockCount = 0;\nvar unwrapHost = (node) => node && (node.host || unwrapHost(node.parentNode));\nvar correctTargets = (parent, targets) => targets.map((target) => {\n  if (parent.contains(target)) return target;\n  const correctedTarget = unwrapHost(target);\n  if (correctedTarget && parent.contains(correctedTarget)) {\n    return correctedTarget;\n  }\n  console.error(\"[zag-js > ariaHidden] target\", target, \"in not contained inside\", parent, \". Doing nothing\");\n  return null;\n}).filter((x) => Boolean(x));\nvar isIgnoredNode = (node) => {\n  if (node.localName === \"next-route-announcer\") return true;\n  if (node.localName === \"script\") return true;\n  if (node.hasAttribute(\"aria-live\")) return true;\n  return node.matches(\"[data-live-announcer]\");\n};\nvar walkTreeOutside = (originalTarget, props) => {\n  const { parentNode, markerName, controlAttribute} = props;\n  const targets = correctTargets(parentNode, Array.isArray(originalTarget) ? originalTarget : [originalTarget]);\n  markerMap[markerName] || (markerMap[markerName] = /* @__PURE__ */ new WeakMap());\n  const markerCounter = markerMap[markerName];\n  const hiddenNodes = [];\n  const elementsToKeep = /* @__PURE__ */ new Set();\n  const elementsToStop = new Set(targets);\n  const keep = (el) => {\n    if (!el || elementsToKeep.has(el)) return;\n    elementsToKeep.add(el);\n    keep(el.parentNode);\n  };\n  targets.forEach(keep);\n  const deep = (parent) => {\n    if (!parent || elementsToStop.has(parent)) {\n      return;\n    }\n    Array.prototype.forEach.call(parent.children, (node) => {\n      if (elementsToKeep.has(node)) {\n        deep(node);\n      } else {\n        try {\n          if (isIgnoredNode(node)) return;\n          const attr = node.getAttribute(controlAttribute);\n          const alreadyHidden = attr === \"true\" ;\n          const counterValue = (counterMap.get(node) || 0) + 1;\n          const markerValue = (markerCounter.get(node) || 0) + 1;\n          counterMap.set(node, counterValue);\n          markerCounter.set(node, markerValue);\n          hiddenNodes.push(node);\n          if (counterValue === 1 && alreadyHidden) {\n            uncontrolledNodes.set(node, true);\n          }\n          if (markerValue === 1) {\n            node.setAttribute(markerName, \"\");\n          }\n          if (!alreadyHidden) {\n            node.setAttribute(controlAttribute, \"true\" );\n          }\n        } catch (e) {\n          console.error(\"[zag-js > ariaHidden] cannot operate on \", node, e);\n        }\n      }\n    });\n  };\n  deep(parentNode);\n  elementsToKeep.clear();\n  lockCount++;\n  return () => {\n    hiddenNodes.forEach((node) => {\n      const counterValue = counterMap.get(node) - 1;\n      const markerValue = markerCounter.get(node) - 1;\n      counterMap.set(node, counterValue);\n      markerCounter.set(node, markerValue);\n      if (!counterValue) {\n        if (!uncontrolledNodes.has(node)) {\n          node.removeAttribute(controlAttribute);\n        }\n        uncontrolledNodes.delete(node);\n      }\n      if (!markerValue) {\n        node.removeAttribute(markerName);\n      }\n    });\n    lockCount--;\n    if (!lockCount) {\n      counterMap = /* @__PURE__ */ new WeakMap();\n      counterMap = /* @__PURE__ */ new WeakMap();\n      uncontrolledNodes = /* @__PURE__ */ new WeakMap();\n      markerMap = {};\n    }\n  };\n};\n\n// src/aria-hidden.ts\nvar getParentNode = (originalTarget) => {\n  const target = Array.isArray(originalTarget) ? originalTarget[0] : originalTarget;\n  return target.ownerDocument.body;\n};\nvar hideOthers = (originalTarget, parentNode = getParentNode(originalTarget), markerName = \"data-aria-hidden\") => {\n  if (!parentNode) return;\n  return walkTreeOutside(originalTarget, {\n    parentNode,\n    markerName,\n    controlAttribute: \"aria-hidden\"});\n};\n\n// src/index.ts\nvar raf = (fn) => {\n  const frameId = requestAnimationFrame(() => fn());\n  return () => cancelAnimationFrame(frameId);\n};\nfunction ariaHidden(targetsOrFn, options = {}) {\n  const { defer = true } = options;\n  const func = defer ? raf : (v) => v();\n  const cleanups = [];\n  cleanups.push(\n    func(() => {\n      const targets = typeof targetsOrFn === \"function\" ? targetsOrFn() : targetsOrFn;\n      const elements = targets.filter(Boolean);\n      if (elements.length === 0) return;\n      cleanups.push(hideOthers(elements));\n    })\n  );\n  return () => {\n    cleanups.forEach((fn) => fn?.());\n  };\n}\n\nexport { ariaHidden };\n"],
  "mappings": "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",
  "names": []
}
